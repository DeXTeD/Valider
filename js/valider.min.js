/*!
 * Valider - HTML5 Form Validation
 * @author Kacper Kozak
 * @version 1.1.0
 * @license MIT
 */
(function($){"use strict";var h=function(c,d){var e=this;this.config=$.extend({onErrors:function(a){},onInputError:function(a,b){},onInputPass:function(a){},lang:$('html').attr('lang')||'pl'},d||{});this.incorrectInputs={};this.form=c;this.inputs=c.find(':input:not(:button, :image, :reset, :submit, :disabled)');this.inputs.each(function(){var b=$(this);b.data('valider',{triggerError:function(a){e.callInputError(a,b)}})});c.on('submit.valider',function(a){e.validate(e.inputs,a)}).attr('novalidate','novalidate');this.inputs.on('blur.valider',function(a){var b=$(this);setTimeout(function(){e.validateInput(b)},350)});return this};h.prototype={regex:{'number':/^-?[0-9]*(\.[0-9]+)?$/,'email':/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/,'url':/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/i},errors:{en:{'*':'Incorrect value','[required]':'Field :name is required','[type=email]':'Invalid email address','[type=number]':'Value must be a number','[type=url]':'Invalid URL','[max]':'The maximum value is :max','[min]':'The minimum value is :min','[data-equals]':'The value is not the same as the field :equals','[data-limit]':'The maximum length is :limit characters'},pl:{'*':'Niepoprawna wartość','[required]':'Pole jest wymagane','[type=email]':'Błędny adres e-mail','[type=number]':'Wartość musi być liczbą','[type=url]':'Niepoprawny adres WWW','[max]':'Maksymalna wartość to :max','[min]':'Minimala wartość to :min','[data-equals]':'Wartość nie jest taka sama jak pole :equals','[data-limit]':'Maksymalna długość to :limit znaków'}},filters:{'[required]':function(a,b){if(a.is(':checkbox')||a.is(':radio')){var c=a.attr('name').match(/^[^\[]+/)[0];return!!this.form.find('input[type="'+a.attr('type')+'"][name^="'+c+'"]:checked').length}return!!b},'[type=email], [data-type=email]':function(a,b){return b===''||this.regex.email.test(b)},'[type=number], [data-type=number]':function(a,b){var c=b.replace(',','.');if(c!==b){a.val(c)}return b===''||this.regex.number.test(c)},'[type=url], [data-type=url]':function(a,b){return b===''||this.regex.url.test(b)},'[max], [data-type=max]':function(a,b){var c=a.attr("max")||a.data("max");return b===''||(parseFloat(b)<=parseFloat(c))},'[min], [data-type=min]':function(a,b){var c=a.attr("min")||a.data("min");return b===''||(parseFloat(b)>=parseFloat(c))},'[pattern]':function(a,b){return b===''||new RegExp("^"+a.attr("pattern")+"$").test(b)},'[data-regex]':function(a,b){return b===''||this.regex[a.data('regex')].test(b)},'[data-equals]':function(a,b){var c=this.inputs.filter('[name='+a.data('equals')+']');return b===c.val()},'[data-limit]':function(a,b){return b===''||a.data('limit')>=b.length},},getError:function(c,d,e){var f=e?e:d.data('message'),attrs={'name':d.data('name')||d.attr('name'),'val':d.val(),'min':d.attr("min")||d.data("min"),'max':d.attr("max")||d.data("max"),'equals':d.data("equalsName")||d.data("equals"),'limit':d.data("limit"),};if(!f){if(c==='[data-regex]'){c='regex:'+d.data('regex')}else{c=c.split(',')[0]}f=this.errors[this.config.lang][c];if(!f){var g=d.data('type');if(g){f=this.errors[this.config.lang]['[type='+g+']']}if(!f){f=this.errors[this.config.lang]['*']}}}$.each(attrs,function(a,b){f=f.replace(':'+a,attrs[a])});return f},callInputError:function(a,b,c){var d=this.getError(a,b,c);this.config.onInputError.call(b,d,b);return d},callInputPass:function(a){this.config.onInputPass.call(a,a)},validateInput:function(c){var d=this,status=true;$.each(this.filters,function(a,b){if(c.is(a)){if(!b.call(d,c,c.val())){d.bindInput(c);status=d.callInputError(a,c);return false}}});return status},bindInput:function(b){var c=this,timer;this.unBindInput(b);b.on('keyup.valider-input change.valider-input click.valider-input',function(){clearTimeout(timer);timer=setTimeout(function(){var a=c.validateInput(b);if(a===true){delete c.incorrectInputs[b.attr('name')];c.unBindInput(b);c.callInputPass(b)}else{c.incorrectInputs[b.attr('name')]=a}},20)})},unBindInput:function(a){a.off('.valider-input')},validate:function(b,c){var d=this,isError=false;b.each(function(){var a=$(this),name=a.attr('name'),check=d.validateInput(a);if(check!==true){d.incorrectInputs[name]=check;isError=true}else if(d.incorrectInputs[name]){delete d.incorrectInputs[name];d.unBindInput(a);d.callInputPass(a)}});if(isError){this.config.onErrors.call(null,this.incorrectInputs,b);c.preventDefault()}},invalidate:function(c){var d=this,inputs=this.inputs;$.each(c,function(a,b){d.callInputError(false,inputs.filter('[name='+a+']'),b)})}};$.Valider={addLang:function(a){$.extend(true,h.prototype.errors,a);return this},addRegex:function(a,b){if(typeof a==='object'){$.extend(h.prototype.regex,a)}else{var c={};c[a]=b;$.extend(h.prototype.regex,c)}return this},addFilter:function(a,b){if(typeof a==='object'){$.extend(h.prototype.filters,a)}else{var c={};c[a]=b;$.extend(h.prototype.filters,c)}return this}};$.fn.Valider=function(b){return this.each(function(){var a=$(this);if(a.is('form')){a.data('valider',new h(a,b))}})}})(window.jQuery);
